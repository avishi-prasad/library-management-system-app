<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Library</title>
    <link rel="stylesheet" href="/static/admin_style.css" >
</head>
<body>
    <h1 style="text-align: left;">
        <img src="/static/app-logo.png" height="40px" width="40px">  My Library
        <span style="float: right;"><img src="/static/account-icon.png" height="27px" width="27px"> Admin Dashboard</span>
    </h1>
    <h2><a href='/admin_dashboard'> <span title="Find all requested and issued books here."> Home</span></a> | Books | <a href="/admin_stats"><span title="See the overall performance of the library">Stats</span></a> | <a href="/"><span title="Logout"> Logout</span></a></h2>
    <div>
        <div style="float: left;">
        {% if sections|length==0 %}
        <a href="/add_section"> Add Section</a>
        {% else %}
        <form action="/books/section" method="POST" id="sectionform" enctype="multipart/form-data" >
        <label><b>Choose Section:</b></label>
        <select id="section" name="section" aria-placeholder="Section">
        <option value="">Select an option</option>
        <option value="all_books">Book List</option>
        {% for i in sections %}
        <option value={{i.Name}}>{{i.Name}}</option>
        {% endfor %}
        </select>
        <br>
        <br>
        <a href="/add_section"> Add Section</a><br><br>
        <a href="/add_books"> Add Books</a>
        </form>
        <script>
            document.getElementById('section').addEventListener('change', function() {
                document.getElementById('sectionform').submit();
            });
        </script>
        {% endif %}
        </div>
        <div style="float: right;">
            <form action="/search" method="POST">
                <label for="search"><b>Search:</b></label>
                <input type="text" id="search" name="search" placeholder="Search by book title/author" required>
                <button type="submit">Search</button>
            </form>
        </div>
    </div>
    <div class="container" style="margin-top: 70px;">
        {% if books|length==0 %}
        <p style="text-align:center ; font-size: 20px;">No books added yet!</p>
        <br>
        <p style="text-align: center;"><a href="/add_books">+Add Books</a></p>
        {% else %}
        <h2 style="text-align: left; background-color: #d9b84c;"><b><span title="{{desc}}"> {{section}}</span></b></h2>
        {% for i in books %}
        <div class="book">
            <img class="image" src={{i.Cover}} height="200" alt="{{i.Title}} cover">
            <div class="details">
                <h3>{{i.Title}}</h3>
                <p><b>Authors:</b> {{i.Authors}}
                <br><b>Genre:</b> {{i.Section}}
                <br><b>No. of Pages:</b> {{i.Pages}}
                <br><b>Ratings: </b>
                    {% for r in book_ratings %}
                    {% if r["Book Title"]==i.Title %}
                    {{r["Avg Rating"]}} <span style="color: #FFD700;"> &#9733;</span>
                    {% endif %}
                    {% endfor %}
                <br><a href="/book/{{i.Book_id}}">Content</a>
                <br><a href="/del_book/{{i.Title}}">Delete Book</a>
                <br><a href="/edit_book/{{i.Title}}">Edit Book</a>
                <br><a href="/see_detail/{{i.Title}}">See Details</a></p>
            </div>
        </div>
        <br>
        {% endfor %}
        {% endif %}
    </div>
</body>
</html>